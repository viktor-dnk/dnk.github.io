{% if site.post_search %}

<div id="beautifuljekyll-search-overlay">

  <div id="nav-search-exit" title="Exit search">✕</div>
  <input type="text" id="nav-search-input" placeholder="Поиск по сайту">
  <ul id="search-results-container"></ul>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    var searchjson = '[ \
  {% for post in site.posts %} \
    { \
      "title"    : "{{ post.title | escape }}", \
      "category" : "{{ post.category }}", \
      "tags"     : "{{ post.tags | join: ', ' }}", \
      "url"      : "{{ site.baseurl }}{{ post.url }}", \
      "date"     : "{{ post.date }}", \
      "content": "{{ page.content | strip_html | strip_newlines | remove_chars | escape }}" \
    } {% unless forloop.last %},{% endunless %} \
  {% endfor %} \
  , \
  {% for page in site.pages %} \
   { \
     {% if page.title != nil %} \
        "title"    : "{{ page.title | escape }}", \
        "category" : "{{ page.category }}", \
        "tags"     : "{{ page.tags | join: ', ' }}", \
        "url"      : "{{ site.baseurl }}{{ page.url }}", \
        "date"     : "{{ page.date }}", \
        "content": "{{ page.content | strip_html | strip_newlines | remove_chars | escape }}" \
     {% endif %} \
   } {% unless forloop.last %},{% endunless %} \
  {% endfor %} \
]';
    searchjson = JSON.parse(searchjson);

    var sjs = SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchjson
    });
  </script>
</div>

{% endif %}
